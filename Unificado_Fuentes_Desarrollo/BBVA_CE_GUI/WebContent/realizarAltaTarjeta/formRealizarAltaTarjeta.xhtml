<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets">
	<f:loadBundle basename="com.ibm.bbva.messages.Messages" var="msg"/>
    <h:head>
    	<meta name="tagCompatible" http-equiv="X-UA-Compatible" content="IE=EDGE"/>
		<meta http-equiv="Pragma" content="no-cache"/>
		<meta http-equiv="Cache-Control" content="no-cache"/>
		<meta http-equiv="Expires" content="0"/>
        <h:outputStylesheet library="css/jquery-ui" name="jquery-ui.css" target="head"/>
		<h:outputStylesheet library="css/theme" name="stylesheet.css" target="head"/>
		<h:outputStylesheet library="css/style" name="style.css" target="head"/>
		<h:outputStylesheet library="css/style" name="stylecabecera.css" target="head"/>
		<h:outputStylesheet library="css/style" name="stylemenu.css" target="head"/>
		<h:outputScript library="js" name="jquery-1.8.2.js" target="head"/>
		<h:outputScript library="js" name="jquery-ui.js" target="head"/>
		<h:outputScript library="js" name="autoNumeric-1.7.4-B.js" target="head"/>
		<h:outputScript library="js" name="funciones.js" target="head"/>
        <h:outputScript target="head">
		/* <![CDATA[ */
            $(document).ready(function(){
              if($("#frmRealizarAltaTarjeta\\:idMsgGuiaDoc").val() == "true") {
				var msg = $("#frmRealizarAltaTarjeta\\:msgGuiaDoc").text();
				var docsPendientes = $("#frmRealizarAltaTarjeta\\:idValidaGuiaEsc").val();
				alert(msg + ":\n" + docsPendientes);
				$("#frmRealizarAltaTarjeta\\:idMsgGuiaDoc").val("false");
			  }               
	          if($("#frmRealizarAltaTarjeta\\:idMsgOperacion").val() == "true") {
	        	var msg = $("#frmRealizarAltaTarjeta\\:msgOperacion").text();
	        	alert(msg);
	        	$("#frmRealizarAltaTarjeta\\:idMsgOperacion").val("false");
	          }else{
		          if($("#frmRealizarAltaTarjeta\\:idMsgOperacionOf").val() == "true") {
		        	var msg = $("#frmRealizarAltaTarjeta\\:msgOperacionOf").text();
		        	alert(msg);
		        	$("#frmRealizarAltaTarjeta\\:idMsgOperacionOf").val("false");
		          }	          
	          }
			  validaVersion();	
            });		
        	function confAceptar (form) {
        		var msg = $("#frmRealizarAltaTarjeta\\:confirmacion").text();
        		var docsObs = $("[id='#{paneldocumentos.htmlListaDocsObservados.clientId}']").val();
		        var msgDocsObs = '';
		        docsObs = $.trim(docsObs);
		        if(docsObs != ''){
		        	msgDocsObs = 'El expediente que estÃ¡ guardando contiene \ndocumentos observados que \nno han sido subsanados:';
		        	msg = msgDocsObs + '\n' + docsObs + '\n\n' + msg; 		
		        }
        		var op = confirm(msg);
        		if (op) {
        			clickAceptar(form);
        		}
        		return op;    
        	}
        	function confDevolver () {
        		var msg = $("#frmRealizarAltaTarjeta\\:devolver").text();
        		return confirm(msg);
        	}
        	function get_browser(){
			    var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || []; 
			    if(/trident/i.test(M[1])){
			        tem=/\brv[ :]+(\d+)/g.exec(ua) || []; 
			        return 'IE '+(tem[1]||'');
			        }   
			    if(M[1]==='Chrome'){
			        tem=ua.match(/\bOPR\/(\d+)/)
			        if(tem!=null)   {return 'Opera '+tem[1];}
			        }   
			    M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
			    if((tem=ua.match(/version\/(\d+)/i))!=null) {M.splice(1,1,tem[1]);}
			    return M[0];
			}
			function get_browser_version(){
			    var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];                                                                                                                         
			    if(/trident/i.test(M[1])){
			        tem=/\brv[ :]+(\d+)/g.exec(ua) || [];
			        return 'IE '+(tem[1]||'');
			        }
			    if(M[1]==='Chrome'){
			        tem=ua.match(/\bOPR\/(\d+)/)
			        if(tem!=null)   {return 'Opera '+tem[1];}
			        }   
			    M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
			    if((tem=ua.match(/version\/(\d+)/i))!=null) {M.splice(1,1,tem[1]);}
			    return M[1];
			}
			function validaVersion(){
				var contenido = "";
				if(get_browser() == 'MSIE'){
					if(get_browser_version() == 8){
						contenido = "IE=8";
					}
					else if(get_browser_version() == 9){
						contenido = "IE=9";
					}
					else{
						contenido = "IE=EDGE";
					}
				}
				else{
					contenido = "IE=EDGE";
				}
				
				var objeto;
				var elem = document.getElementsByTagName('meta');
				var filas = 0;
			    for(i = 0; i < elem.length; i++) {
			         att = elem[i].getAttribute("name");
			         if(att == 'tagCompatible') {
			              objeto = elem[i];
			         }
			    }
			    objeto.setAttribute("content",contenido);
			}
			        	        	
        /* ]]> */
		</h:outputScript>
		<script type="text/javascript">
	        function checkClick2(check) {
	            document.getElementById('frmRealizarAltaTarjeta:idValorTasaEsp3').disabled = !check.checked; 
	            document.getElementById('frmRealizarAltaTarjeta:idValorTasaEsp3').value = "0.00"; 
	        }
	        function mostrarTabLogPorPerfil(){
	        	var perfil = $("#frmRealizarAltaTarjeta\\:descPerfilPage").val();
	        	var descAdmin = $("#frmRealizarAltaTarjeta\\:descPerfilFiltro").val();
	        	perfil = (perfil == "")?$("#frmRealizarAltaTarjeta\\:descPerfilPage").text():perfil;
	        	descAdmin = (descAdmin == "")?$("#frmRealizarAltaTarjeta\\:descPerfilFiltro").text():descAdmin;
	        	if (perfil == descAdmin) {
	        		$("#frmRealizarAltaTarjeta\\:descPerfilTabs").show();
	        	} else {
	        		$("#frmRealizarAltaTarjeta\\:descPerfilTabs").hide();
	        	}
	        }
		</script>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>
        <title><h:outputText value="#{msg['com.ibm.bbva.realizarAltaTarjeta.formRealizarAltaTarjeta.titulo']}"/></title>
    </h:head>
    <h:body onload="mostrarTabLogPorPerfil()">
	    <h:form id="frmRealizarAltaTarjeta">
		    <h:inputHidden value="#{detalleExpediente.clienteNatural.estadoCivil.codigo}"  id="datoCivil"></h:inputHidden> 
			<h:inputHidden value="#{datosConyuge.mensajeOperacion}" id="msjObservacion" />	
			<h:inputHidden value="#{datosProducto3.expediente.expedienteTC.tipoOferta.codigo}" id="idTipoOferta"/>
			<h:inputHidden id="idMsgGuiaDoc" value="#{realizarAltaTarjeta.msgGuiaDocumentaria}"></h:inputHidden>
			    
	    	<h:outputText value="#{msg['com.ibm.bbva.realizarAltaTarjeta.formRealizarAltaTarjeta.aceptar.confirm']}"
	    			id="confirmacion" style="display:none;"/>
	    	<h:outputText value="#{msg['com.ibm.bbva.realizarAltaTarjeta.formRealizarAltaTarjeta.devolver.confirm']}"
	    			id="devolver" style="display:none;"/>
	    	<h:outputText value="#{msg['com.ibm.bbva.realizarAltaTarjeta.formRealizarAltaTarjeta.msgGuiaDoc']}"
   			    id="msgGuiaDoc" style="display:none;"/>		
	    			    			
	        <div class="contenido">
	            <div class="cabecera">
	                <ui:include src="/resources/common/cabecera.xhtml" />
	                <h:outputText id="descPerfilPage"  value="#{datosCabecera.empleado.perfil.descripcion}" style="display:none;"/>
	                <h:outputText id="descPerfilFiltro"  value="#{msg['com.ibm.bbva.common.perfil.administrador']}" style="display:none;"/>
	            </div>
	            <div class="cuerpo">
	                <div class="menu">
	                    <ui:include src="/resources/common/menu.xhtml" />
	                </div>
	                <div class="datos">
	                	<ui:include src="/resources/common/tabs.xhtml" />
	                	<div class="tab-expediente tab-item">
		                	<ui:include src="/resources/common/datosGestor.xhtml" />
							<ui:include src="/resources/common/estadoAnterior.xhtml" />
							<ui:include src="/resources/common/detalleExpediente.xhtml" />
							<h:panelGroup id="idPanelDatosConyuge" 
							style="#{datosConyuge.mostrarDatosConyugePrincipal ? '':'display:none;'}" >
								<ui:include src="/resources/common/datosConyugue.xhtml" />
							</h:panelGroup>				
							<ui:include src="/resources/common/datosProducto3.xhtml" />
							<!-- 
							<ui:include src="/resources/common/verificacionApr.xhtml" />
							 -->
							 
							 <h:panelGroup id="idDocumentosReutilizables"/>
							 
							<h:panelGroup layout="block" styleClass="bloque">
								<h:panelGroup id="appletContentRefresh">
									<ui:include src="/resources/common/documentoEsc.xhtml" />
								</h:panelGroup>
								<h:panelGroup id="idPanelDocumentos">
									<ui:include src="/resources/common/panelDocumentos.xhtml" />
								</h:panelGroup>
							</h:panelGroup>	
							<ui:include src="/resources/common/comentarios.xhtml" />
							<ui:include src="/resources/common/observacionRechazo.xhtml" />
							<!--ui:include src="/resources/common/correo.xhtml" /--><!-- TODO modal -->
							<h:outputText value="#{realizarAltaTarjeta.msgPersonalizado}" escape="false"/>
							<div class="column boton-principal" style="widht:50px;">					
							    <h:commandButton value="#{msg['com.ibm.bbva.realizarAltaTarjeta.formRealizarAltaTarjeta.aceptar']}"
		            		                     onclick="return confAceptar(this.form);" type="button" />
												
							    <h:commandButton value="#{msg['com.ibm.bbva.realizarAltaTarjeta.formRealizarAltaTarjeta.devolver']}"
		            		                     action="#{realizarAltaTarjeta.devolver}" onclick="return confDevolver();"/>	
		            		                     
		            		    <h:commandLink id="btnEjecutaApplet" 
		    	                           action="#{realizarAltaTarjeta.aceptar}"
		    	                           styleClass="display:none">
		    	                </h:commandLink>				       					
							</div>
						</div>
						<div class="tab-ayuda-memoria tab-item" style="display:none;">
							<ui:include src="/resources/common/datosHistorico.xhtml" />		
		               		<ui:include src="/resources/common/tablaAyudaMemoria.xhtml" />
						</div>
						<div class="tab-historial tab-item" style="display:none;">
							<ui:include src="/resources/common/datosHistorico.xhtml" />	
	               			<ui:include src="/resources/common/tablaHistorial.xhtml" />
						</div>
						<div class="tab-observaciones tab-item" style="display:none;">
							<ui:include src="/resources/common/datosHistorico.xhtml" />
							<ui:include src="/resources/common/tablaObservaciones.xhtml" />
						</div>
						<div class="tab-log tab-item" style="display:none;">
		               		<ui:include src="/resources/common/datosHistorico.xhtml" />	
		               		<ui:include src="/resources/common/tablaLog.xhtml" />
						</div>
					</div>
	            </div>
	        </div>
	    </h:form>
    </h:body>
</html>